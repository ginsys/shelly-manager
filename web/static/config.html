<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shelly Manager - Configuration Templates</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #2c3e50, #3498db);
            color: white;
            padding: 30px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-content {
            text-align: center;
            flex: 1;
        }

        .header-nav {
            display: flex;
            gap: 15px;
        }

        .nav-link {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .main-content {
            padding: 40px;
        }

        .config-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid #e9ecef;
        }

        .section-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .template-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        .template-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .template-description {
            color: #666;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-right: 8px;
            margin-bottom: 8px;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
        }

        .btn-success {
            background: linear-gradient(45deg, #27ae60, #219a52);
        }

        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .editor-panel {
            background: white;
            border-radius: 10px;
            border: 1px solid #e9ecef;
            overflow: hidden;
        }

        .editor-header {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
            font-weight: 600;
            color: #2c3e50;
        }

        .editor-content {
            padding: 15px;
        }

        .code-editor {
            width: 100%;
            min-height: 300px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            background: #f8f9fa;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .code-editor.error {
            border-color: #e74c3c;
            background: #fdf2f2;
        }

        .code-editor:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .variable-panel {
            background: #fff;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .variable-group {
            padding: 15px;
            border-bottom: 1px solid #e9ecef;
        }

        .variable-group:last-child {
            border-bottom: none;
        }

        .variable-group-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .variable-input {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .variable-input label {
            min-width: 120px;
            font-size: 0.9rem;
            color: #666;
        }

        .variable-input input {
            flex: 1;
            padding: 6px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .variable-input input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .function-reference {
            background: #e8f4fd;
            border: 1px solid #bee5eb;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .function-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 8px;
            margin-top: 10px;
        }

        .function-item {
            background: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.85rem;
            border: 1px solid #bee5eb;
        }

        .status-message {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-info {
            background: #cce7ff;
            color: #004085;
            border: 1px solid #b3d7ff;
        }

        .hidden {
            display: none;
        }

        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>Configuration Templates</h1>
                <p>Manage device configuration templates with variable substitution</p>
            </div>
            <div class="header-nav">
                <a href="/" class="nav-link">üìä Device List</a>
                <a href="/dashboard.html" class="nav-link">üìà Dashboard</a>
                <a href="/config.html" class="nav-link">‚öôÔ∏è Templates</a>
            </div>
        </div>

        <div class="main-content">
            <!-- Template Examples Section -->
            <div class="config-section">
                <h2 class="section-title">üìã Template Examples</h2>
                <p>Pre-built configuration templates for common use cases</p>
                
                <div class="template-grid" id="templateGrid">
                    <!-- Template cards will be populated by JavaScript -->
                </div>
            </div>

            <!-- Template Editor Section -->
            <div class="config-section">
                <h2 class="section-title">‚úèÔ∏è Template Editor</h2>
                
                <div id="statusMessage" class="hidden"></div>

                <div class="editor-container">
                    <div class="editor-panel">
                        <div class="editor-header">Template Configuration (JSON)</div>
                        <div class="editor-content">
                            <textarea id="templateEditor" class="code-editor" placeholder="Enter your configuration template here...&#10;&#10;Example:&#10;{&#10;  &quot;wifi_sta&quot;: {&#10;    &quot;enable&quot;: true,&#10;    &quot;ssid&quot;: &quot;{{.Network.SSID}}&quot;,&#10;    &quot;pass&quot;: &quot;{{.Custom.wifi_password}}&quot;&#10;  },&#10;  &quot;sys&quot;: {&#10;    &quot;device&quot;: {&#10;      &quot;name&quot;: &quot;{{deviceShortName .Device.Model .Device.MAC}}&quot;&#10;    }&#10;  }&#10;}"></textarea>
                        </div>
                    </div>

                    <div class="editor-panel">
                        <div class="editor-header">Preview Result</div>
                        <div class="editor-content">
                            <textarea id="previewEditor" class="code-editor" readonly placeholder="Template preview will appear here after processing..."></textarea>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 15px;">
                    <button id="previewBtn" class="btn">üîç Preview Template</button>
                    <button id="realTimeBtn" class="btn btn-secondary" onclick="toggleRealTimePreview()">‚ñ∂Ô∏è Enable Live Preview</button>
                    <button id="validateBtn" class="btn btn-secondary">‚úÖ Validate Syntax</button>
                    <button id="saveBtn" class="btn btn-success">üíæ Save Template</button>
                </div>
            </div>

            <!-- Variable Configuration Section -->
            <div class="config-section">
                <h2 class="section-title">üîß Template Variables</h2>
                
                <div class="variable-panel">
                    <div class="variable-group">
                        <div class="variable-group-title">Network Settings</div>
                        <div class="variable-input">
                            <label>WiFi SSID:</label>
                            <input type="text" id="networkSSID" placeholder="MyNetwork" value="TestNetwork">
                        </div>
                        <div class="variable-input">
                            <label>WiFi Password:</label>
                            <input type="password" id="wifiPassword" placeholder="password123">
                        </div>
                        <div class="variable-input">
                            <label>Gateway:</label>
                            <input type="text" id="networkGateway" placeholder="192.168.1.1" value="192.168.1.1">
                        </div>
                        <div class="variable-input">
                            <label>DNS Server:</label>
                            <input type="text" id="networkDNS" placeholder="8.8.8.8" value="8.8.8.8">
                        </div>
                    </div>

                    <div class="variable-group">
                        <div class="variable-group-title">Device Settings</div>
                        <div class="variable-input">
                            <label>Device Name:</label>
                            <input type="text" id="deviceName" placeholder="Living Room Switch">
                        </div>
                        <div class="variable-input">
                            <label>Enable Auth:</label>
                            <input type="checkbox" id="enableAuth">
                        </div>
                        <div class="variable-input">
                            <label>Auth Username:</label>
                            <input type="text" id="authUsername" placeholder="admin" value="admin">
                        </div>
                        <div class="variable-input">
                            <label>Auth Password:</label>
                            <input type="password" id="authPassword" placeholder="secure123">
                        </div>
                    </div>

                    <div class="variable-group">
                        <div class="variable-group-title">MQTT Settings</div>
                        <div class="variable-input">
                            <label>Enable MQTT:</label>
                            <input type="checkbox" id="enableMQTT">
                        </div>
                        <div class="variable-input">
                            <label>MQTT Server:</label>
                            <input type="text" id="mqttServer" placeholder="mqtt.example.com">
                        </div>
                        <div class="variable-input">
                            <label>MQTT Port:</label>
                            <input type="number" id="mqttPort" placeholder="1883" value="1883">
                        </div>
                        <div class="variable-input">
                            <label>MQTT Topic Prefix:</label>
                            <input type="text" id="mqttPrefix" placeholder="homeassistant">
                        </div>
                    </div>

                    <div class="variable-group">
                        <div class="variable-group-title">Location Settings</div>
                        <div class="variable-input">
                            <label>Timezone:</label>
                            <input type="text" id="timezone" placeholder="Europe/London" value="UTC">
                        </div>
                        <div class="variable-input">
                            <label>Latitude:</label>
                            <input type="number" id="latitude" placeholder="51.5074" step="0.0001">
                        </div>
                        <div class="variable-input">
                            <label>Longitude:</label>
                            <input type="number" id="longitude" placeholder="-0.1278" step="0.0001">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Function Reference Section -->
            <div class="config-section">
                <h2 class="section-title">üìö Template Function Reference</h2>
                
                <div class="function-reference">
                    <strong>Available Template Functions:</strong>
                    <div class="function-list">
                        <div class="function-item">{{.Device.MAC | macLast4}}</div>
                        <div class="function-item">{{.Device.MAC | macLast6}}</div>
                        <div class="function-item">{{.Device.MAC | macColon}}</div>
                        <div class="function-item">{{.Device.MAC | macDash}}</div>
                        <div class="function-item">{{.Device.MAC | macNone}}</div>
                        <div class="function-item">{{deviceShortName .Device.Model .Device.MAC}}</div>
                        <div class="function-item">{{.Device.Name | hostName}}</div>
                        <div class="function-item">{{.Custom.value | default "fallback"}}</div>
                        <div class="function-item">{{.Network.SSID | required}}</div>
                        <div class="function-item">{{now | formatTime "2006-01-02"}}</div>
                        <div class="function-item">{{.Device.IP | ipLast}}</div>
                        <div class="function-item">{{.Text | upper | trim}}</div>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <strong>Template Variables:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li><code>.Device.*</code> - Device information (ID, MAC, IP, Name, Model, etc.)</li>
                            <li><code>.Network.*</code> - Network settings (SSID, Gateway, DNS, etc.)</li>
                            <li><code>.Custom.*</code> - Custom variables defined above</li>
                            <li><code>.Auth.*</code> - Authentication settings</li>
                            <li><code>.Location.*</code> - Time and location settings</li>
                            <li><code>.System.*</code> - System information and timestamps</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Template examples data
        const templateExamples = {
            'basic_wifi': {
                name: 'Basic WiFi Configuration',
                description: 'Simple WiFi connection setup',
                content: `{
  "wifi_sta": {
    "enable": true,
    "ssid": "{{.Network.SSID}}",
    "pass": "{{.Custom.wifi_password}}"
  },
  "sys": {
    "device": {
      "name": "{{deviceShortName .Device.Model .Device.MAC}}"
    }
  }
}`
            },
            'gen2_comprehensive': {
                name: 'Gen2 Comprehensive Setup',
                description: 'Full Gen2+ device configuration with MQTT',
                content: `{
  "wifi_sta": {
    "enable": true,
    "ssid": "{{.Network.SSID}}",
    "pass": "{{.Custom.wifi_password}}"
  },
  "sys": {
    "device": {
      "name": "{{.Custom.device_name | default (deviceShortName .Device.Model .Device.MAC)}}",
      "discoverable": true
    },
    "location": {
      "tz": "{{.Location.Timezone}}",
      "lat": {{.Location.Latitude | default 0}},
      "lng": {{.Location.Longitude | default 0}}
    }
  },
  "mqtt": {
    "enable": {{.Custom.enable_mqtt | default false}},
    "server": "{{.Custom.mqtt_server}}:{{.Custom.mqtt_port | default 1883}}",
    "topic_prefix": "{{.Custom.mqtt_prefix | default "shelly"}}/{{.Device.MAC | macNone}}"
  }
}`
            },
            'authentication_required': {
                name: 'Secure Device Setup',
                description: 'Configuration with authentication enabled',
                content: `{
  "auth": {
    "enable": true,
    "user": "{{.Auth.Username}}",
    "pass": "{{.Auth.Password}}"
  },
  "wifi_sta": {
    "enable": true,
    "ssid": "{{.Network.SSID}}",
    "pass": "{{.Custom.wifi_password}}"
  },
  "sys": {
    "device": {
      "name": "{{.Custom.device_name | default (deviceShortName .Device.Model .Device.MAC)}}",
      "discoverable": false
    }
  }
}`
            },
            'static_ip_config': {
                name: 'Static IP Configuration',
                description: 'Fixed IP address setup',
                content: `{
  "wifi_sta": {
    "enable": true,
    "ssid": "{{.Network.SSID}}",
    "pass": "{{.Custom.wifi_password}}",
    "ipv4mode": "static",
    "static_ip": {
      "ip": "{{.Custom.static_ip}}",
      "netmask": "{{.Custom.netmask | default "255.255.255.0"}}",
      "gw": "{{.Custom.gateway}}",
      "nameserver": "{{.Custom.dns | default "8.8.8.8"}}"
    }
  },
  "sys": {
    "device": {
      "name": "{{.Custom.device_name | default (deviceShortName .Device.Model .Device.MAC)}}"
    }
  }
}`
            }
        };

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadTemplateExamples();
            bindEventListeners();
            
            // Load default template
            const templateEditor = document.getElementById('templateEditor');
            templateEditor.value = templateExamples.basic_wifi.content;
        });

        function loadTemplateExamples() {
            const templateGrid = document.getElementById('templateGrid');
            templateGrid.innerHTML = '';

            Object.entries(templateExamples).forEach(([key, template]) => {
                const card = document.createElement('div');
                card.className = 'template-card';
                card.innerHTML = `
                    <div class="template-name">${template.name}</div>
                    <div class="template-description">${template.description}</div>
                    <button class="btn" onclick="loadTemplate('${key}')">üìÑ Load Template</button>
                    <button class="btn btn-secondary" onclick="previewTemplate('${key}')">üëÅÔ∏è Preview</button>
                `;
                templateGrid.appendChild(card);
            });
        }

        function bindEventListeners() {
            document.getElementById('previewBtn').addEventListener('click', previewCurrentTemplate);
            document.getElementById('validateBtn').addEventListener('click', validateTemplate);
            document.getElementById('saveBtn').addEventListener('click', saveTemplate);
            
            // Real-time preview on template changes
            const templateEditor = document.getElementById('templateEditor');
            templateEditor.addEventListener('input', schedulePreview);
            
            // Real-time preview on variable changes
            const variableInputs = document.querySelectorAll('.variable-input input');
            variableInputs.forEach(input => {
                input.addEventListener('input', schedulePreview);
            });
        }

        function loadTemplate(templateKey) {
            const template = templateExamples[templateKey];
            if (template) {
                document.getElementById('templateEditor').value = template.content;
                showStatus('Template loaded: ' + template.name, 'success');
            }
        }

        function previewTemplate(templateKey) {
            const template = templateExamples[templateKey];
            if (template) {
                document.getElementById('templateEditor').value = template.content;
                previewCurrentTemplate();
            }
        }

        // Real-time template processing with debouncing
        let previewTimeout = null;
        let isPreviewEnabled = false;

        function previewCurrentTemplate() {
            const templateContent = document.getElementById('templateEditor').value;
            const variables = gatherVariables();
            
            if (!templateContent.trim()) {
                document.getElementById('previewEditor').value = '';
                return;
            }
            
            showStatus('Processing template...', 'info');
            setLoading(true);

            fetch('/api/v1/configuration/preview-template', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    template: templateContent,
                    variables: variables
                })
            })
            .then(response => response.json())
            .then(data => {
                setLoading(false);
                
                if (data.error) {
                    showStatus('Template error: ' + data.error, 'error');
                    document.getElementById('previewEditor').value = 'Error processing template:\n' + data.error;
                    highlightTemplateErrors(data.error);
                } else {
                    showStatus('Template processed successfully!', 'success');
                    document.getElementById('previewEditor').value = JSON.stringify(data.result, null, 2);
                    clearTemplateErrors();
                }
            })
            .catch(error => {
                setLoading(false);
                showStatus('Network error: ' + error.message, 'error');
                console.error('Preview error:', error);
                document.getElementById('previewEditor').value = 'Network error: ' + error.message;
            });
        }

        // Real-time preview with debouncing
        function schedulePreview() {
            if (!isPreviewEnabled) return;
            
            if (previewTimeout) {
                clearTimeout(previewTimeout);
            }
            
            previewTimeout = setTimeout(() => {
                previewCurrentTemplate();
            }, 500); // 500ms debounce
        }

        function toggleRealTimePreview() {
            isPreviewEnabled = !isPreviewEnabled;
            const button = document.getElementById('realTimeBtn');
            
            if (isPreviewEnabled) {
                button.textContent = '‚è∏Ô∏è Pause Live Preview';
                button.classList.add('btn-success');
                schedulePreview(); // Initial preview
            } else {
                button.textContent = '‚ñ∂Ô∏è Enable Live Preview';
                button.classList.remove('btn-success');
                if (previewTimeout) {
                    clearTimeout(previewTimeout);
                }
            }
        }

        function highlightTemplateErrors(error) {
            const editor = document.getElementById('templateEditor');
            editor.classList.add('error');
            
            // Try to highlight specific error lines if possible
            if (error.includes('line')) {
                const lineMatch = error.match(/line (\d+)/);
                if (lineMatch) {
                    const lineNum = parseInt(lineMatch[1]);
                    const lines = editor.value.split('\n');
                    if (lineNum <= lines.length) {
                        // Could implement line highlighting here
                        console.log(`Error on line ${lineNum}: ${lines[lineNum - 1]}`);
                    }
                }
            }
        }

        function clearTemplateErrors() {
            const editor = document.getElementById('templateEditor');
            editor.classList.remove('error');
        }

        function validateTemplate() {
            const templateContent = document.getElementById('templateEditor').value;
            
            if (!templateContent.trim()) {
                showStatus('Please enter a template to validate', 'error');
                return;
            }

            showStatus('Validating template...', 'info');
            setLoading(true);

            fetch('/api/v1/configuration/validate-template', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    template: templateContent
                })
            })
            .then(response => response.json())
            .then(data => {
                setLoading(false);
                
                if (data.valid) {
                    showStatus('‚úÖ Template syntax is valid!', 'success');
                } else {
                    showStatus('‚ùå Template validation failed: ' + data.error, 'error');
                }
            })
            .catch(error => {
                setLoading(false);
                showStatus('Validation error: ' + error.message, 'error');
                console.error('Validation error:', error);
            });
        }

        function saveTemplate() {
            const templateContent = document.getElementById('templateEditor').value;
            const templateName = prompt('Enter a name for this template:');
            
            if (!templateName) return;
            
            showStatus('Saving template...', 'info');
            setLoading(true);

            fetch('/api/v1/configuration/templates', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    name: templateName,
                    template: templateContent,
                    variables: gatherVariables()
                })
            })
            .then(response => response.json())
            .then(data => {
                setLoading(false);
                
                if (data.success) {
                    showStatus('‚úÖ Template saved successfully!', 'success');
                } else {
                    showStatus('‚ùå Failed to save template: ' + (data.error || 'Unknown error'), 'error');
                }
            })
            .catch(error => {
                setLoading(false);
                showStatus('Save error: ' + error.message, 'error');
                console.error('Save error:', error);
            });
        }

        function gatherVariables() {
            return {
                network: {
                    ssid: document.getElementById('networkSSID').value,
                    gateway: document.getElementById('networkGateway').value,
                    dns: document.getElementById('networkDNS').value
                },
                custom: {
                    wifi_password: document.getElementById('wifiPassword').value,
                    device_name: document.getElementById('deviceName').value,
                    enable_auth: document.getElementById('enableAuth').checked,
                    enable_mqtt: document.getElementById('enableMQTT').checked,
                    mqtt_server: document.getElementById('mqttServer').value,
                    mqtt_port: parseInt(document.getElementById('mqttPort').value) || 1883,
                    mqtt_prefix: document.getElementById('mqttPrefix').value || 'homeassistant',
                    static_ip: '192.168.1.50',
                    gateway: document.getElementById('networkGateway').value,
                    netmask: '255.255.255.0',
                    dns: document.getElementById('networkDNS').value
                },
                auth: {
                    username: document.getElementById('authUsername').value,
                    password: document.getElementById('authPassword').value
                },
                location: {
                    timezone: document.getElementById('timezone').value,
                    latitude: parseFloat(document.getElementById('latitude').value) || 0,
                    longitude: parseFloat(document.getElementById('longitude').value) || 0
                }
            };
        }

        function showStatus(message, type) {
            const statusEl = document.getElementById('statusMessage');
            statusEl.className = `status-message status-${type}`;
            statusEl.textContent = message;
            statusEl.classList.remove('hidden');
            
            if (type === 'success' || type === 'info') {
                setTimeout(() => {
                    statusEl.classList.add('hidden');
                }, 5000);
            }
        }

        function setLoading(loading) {
            const container = document.querySelector('.main-content');
            if (loading) {
                container.classList.add('loading');
            } else {
                container.classList.remove('loading');
            }
        }
    </script>
</body>
</html>