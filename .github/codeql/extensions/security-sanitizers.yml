# CodeQL model extensions for Shelly Manager
# Defines custom sanitizers for path validation functions
#
# These functions validate and sanitize user-provided paths to prevent
# path traversal attacks. They ensure paths stay within allowed directories.

extensions:
  # neutralModel marks functions as sanitizers/barriers for specific vulnerability types
  # Signature: neutralModel(package, type, name, signature, kind, provenance)
  - addsTo:
      pack: codeql/go-all
      extensible: neutralModel
    data:
      # Mark ValidatePath as a sanitizer for path injection
      # This function validates paths are within a base directory
      - ["github.com/ginsys/shelly-manager/internal/security", "", "ValidatePath", "", "path-injection", "manual"]
      - ["github.com/ginsys/shelly-manager/internal/security", "", "ValidatePathWithSymlinks", "", "path-injection", "manual"]
      - ["github.com/ginsys/shelly-manager/internal/security", "", "SanitizeFilename", "", "path-injection", "manual"]
